{"ast":null,"code":"import React,{useState}from'react';import{Box,Card,CardContent,TextField,Button,Typography,Container,Alert,Link}from'@mui/material';import{useAuthContext}from'../hooks/useAuth';// Types\nimport{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const Login=()=>{const{login}=useAuthContext();const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[error,setError]=useState(null);const[isLoading,setIsLoading]=useState(false);const validateForm=()=>{if(!email){setError('Email is required');return false;}if(!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)){setError('Please enter a valid email address');return false;}if(!password){setError('Password is required');return false;}if(password.length<8){setError('Password must be at least 8 characters long');return false;}return true;};const handleSubmit=async e=>{e.preventDefault();setError(null);if(!validateForm()){return;}setIsLoading(true);try{const formData={email,password};const success=await login(formData);if(!success){throw new Error('Invalid email or password');}// Double check authentication state before proceeding\nconst token=localStorage.getItem('token');const tokenExpiry=localStorage.getItem('token_expiry');if(!token||!tokenExpiry){throw new Error('Authentication failed. Please try again.');}// Navigation is handled by useAuth hook after successful login\n}catch(error){console.error('Login error:',error);setError(error instanceof Error?error.message:'Authentication failed. Please try again.');// Clear any partial authentication state\nlocalStorage.removeItem('token');localStorage.removeItem('token_expiry');}finally{setIsLoading(false);}};return/*#__PURE__*/_jsx(Container,{maxWidth:\"sm\",children:/*#__PURE__*/_jsx(Box,{sx:{minHeight:'100vh',display:'flex',alignItems:'center',justifyContent:'center'},children:/*#__PURE__*/_jsx(Card,{sx:{width:'100%'},children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h5\",gutterBottom:true,align:\"center\",children:\"Login to Lumix Trading\"}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:2},children:error}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Email\",type:\"email\",value:email,onChange:e=>setEmail(e.target.value),margin:\"normal\",required:true}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Password\",type:\"password\",value:password,onChange:e=>setPassword(e.target.value),margin:\"normal\",required:true}),/*#__PURE__*/_jsx(Button,{fullWidth:true,variant:\"contained\",type:\"submit\",sx:{mt:3},disabled:isLoading,children:isLoading?'Signing in...':'Login'}),/*#__PURE__*/_jsx(Box,{sx:{mt:2,textAlign:'center'},children:/*#__PURE__*/_jsx(Link,{href:\"/signup\",variant:\"body2\",children:\"Don't have an account? Sign up\"})})]})]})})})});};export default Login;","map":{"version":3,"names":["React","useState","Box","Card","CardContent","TextField","Button","Typography","Container","Alert","Link","useAuthContext","jsx","_jsx","jsxs","_jsxs","Login","login","email","setEmail","password","setPassword","error","setError","isLoading","setIsLoading","validateForm","test","length","handleSubmit","e","preventDefault","formData","success","Error","token","localStorage","getItem","tokenExpiry","console","message","removeItem","maxWidth","children","sx","minHeight","display","alignItems","justifyContent","width","variant","gutterBottom","align","severity","mb","onSubmit","fullWidth","label","type","value","onChange","target","margin","required","mt","disabled","textAlign","href"],"sources":["/home/ubuntu/repos/tradingbot/src/frontend/src/pages/Login.tsx"],"sourcesContent":["import React, { useState } from 'react';\nimport {\n  Box,\n  Card,\n  CardContent,\n  TextField,\n  Button,\n  Typography,\n  Container,\n  Alert,\n  Link,\n} from '@mui/material';\nimport { useAuthContext } from '../hooks/useAuth';\n\n// Types\ninterface LoginFormData {\n  email: string;\n  password: string;\n}\n\nconst Login: React.FC = () => {\n  const { login } = useAuthContext();\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [error, setError] = useState<string | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  const validateForm = () => {\n    if (!email) {\n      setError('Email is required');\n      return false;\n    }\n    if (!/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(email)) {\n      setError('Please enter a valid email address');\n      return false;\n    }\n    if (!password) {\n      setError('Password is required');\n      return false;\n    }\n    if (password.length < 8) {\n      setError('Password must be at least 8 characters long');\n      return false;\n    }\n    return true;\n  };\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setError(null);\n    \n    if (!validateForm()) {\n      return;\n    }\n    \n    setIsLoading(true);\n    try {\n      const formData = {\n        email,\n        password\n      };\n      \n      const success = await login(formData);\n      if (!success) {\n        throw new Error('Invalid email or password');\n      }\n      \n      // Double check authentication state before proceeding\n      const token = localStorage.getItem('token');\n      const tokenExpiry = localStorage.getItem('token_expiry');\n      \n      if (!token || !tokenExpiry) {\n        throw new Error('Authentication failed. Please try again.');\n      }\n      \n      // Navigation is handled by useAuth hook after successful login\n    } catch (error) {\n      console.error('Login error:', error);\n      setError(error instanceof Error ? error.message : 'Authentication failed. Please try again.');\n      // Clear any partial authentication state\n      localStorage.removeItem('token');\n      localStorage.removeItem('token_expiry');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  return (\n    <Container maxWidth=\"sm\">\n      <Box\n        sx={{\n          minHeight: '100vh',\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n        }}\n      >\n        <Card sx={{ width: '100%' }}>\n          <CardContent>\n            <Typography variant=\"h5\" gutterBottom align=\"center\">\n              Login to Lumix Trading\n            </Typography>\n            \n            {error && (\n              <Alert severity=\"error\" sx={{ mb: 2 }}>\n                {error}\n              </Alert>\n            )}\n\n            <form onSubmit={handleSubmit}>\n              <TextField\n                fullWidth\n                label=\"Email\"\n                type=\"email\"\n                value={email}\n                onChange={(e) => setEmail(e.target.value)}\n                margin=\"normal\"\n                required\n              />\n              <TextField\n                fullWidth\n                label=\"Password\"\n                type=\"password\"\n                value={password}\n                onChange={(e) => setPassword(e.target.value)}\n                margin=\"normal\"\n                required\n              />\n              <Button\n                fullWidth\n                variant=\"contained\"\n                type=\"submit\"\n                sx={{ mt: 3 }}\n                disabled={isLoading}\n              >\n                {isLoading ? 'Signing in...' : 'Login'}\n              </Button>\n              <Box sx={{ mt: 2, textAlign: 'center' }}>\n                <Link href=\"/signup\" variant=\"body2\">\n                  Don't have an account? Sign up\n                </Link>\n              </Box>\n            </form>\n          </CardContent>\n        </Card>\n      </Box>\n    </Container>\n  );\n};\n\nexport type { LoginFormData };\nexport default Login;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}